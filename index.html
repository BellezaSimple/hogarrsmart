<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HogarSmart — Soluciones prácticas para tu hogar</title>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

  <style>
    /* -----------------------------------------
       Paleta: grises / negro / blanco + amarillo
    ------------------------------------------*/
    :root{
      --bg:#fafafa;
      --surface:#ffffff;
      --muted-1:#f2f2f2;
      --muted-2:#e6e6e6;
      --text:#222;
      --muted-text:#6b6b6b;
      --accent:#f6c85f; /* amarillo */
      --accent-dark:#e4b84b;
      --shadow: rgba(16,24,32,0.06);
      --max-width:1200px;
      --radius:14px;
      --glass: rgba(255,255,255,0.6);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:'Poppins',sans-serif;
      background:linear-gradient(180deg,var(--bg) 0%, #ffffff 100%);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
    }
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}

    /* ---------- Header ---------- */
    header{
      position:fixed;top:0;left:0;right:0;height:68px;
      display:flex;align-items:center;justify-content:space-between;padding:0 18px;
      background:rgba(255,255,255,0.8);backdrop-filter: blur(6px);
      border-bottom:1px solid var(--muted-2);z-index:1500;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo{
      width:48px;height:48px;border-radius:10px;
      background:linear-gradient(180deg,#fff,#f4f4f4);
      border:1px solid var(--muted-2);display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--text);
      box-shadow:0 8px 18px rgba(0,0,0,0.04);
      font-size:14px
    }
    .brand .title{font-weight:700;font-size:1rem;color:#111}
    nav.desktop{display:none}

    /* hamburger (panel) */
    .hamburger{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:transparent;border:none;cursor:pointer}
    .burger-lines{width:22px;height:2px;background:#222;border-radius:2px;position:relative}
    .burger-lines::before,.burger-lines::after{content:"";position:absolute;left:0;width:22px;height:2px;background:#222;border-radius:2px}
    .burger-lines::before{top:-7px}.burger-lines::after{top:7px}
    .hamburger.open .burger-lines{background:transparent}
    .hamburger.open .burger-lines::before{transform:translateY(7px) rotate(45deg)}
    .hamburger.open .burger-lines::after{transform:translateY(-7px) rotate(-45deg)}

    main{padding-top:92px}
    .container{max-width:var(--max-width);margin:0 auto;padding:0 18px}

    /* ---------- HERO / INICIO ---------- */
    #inicio{padding:46px 0 32px}
    .hero{
      display:grid;grid-template-columns:1fr;gap:18px;align-items:center;
    }
    .hero-card{
      background:linear-gradient(180deg, rgba(255,255,255,0.95), rgba(250,250,250,0.95));
      padding:26px;border-radius:16px;box-shadow:0 12px 40px rgba(16,24,32,0.06);
      display:flex;gap:22px;align-items:center;justify-content:space-between;
    }
    .hero-left{max-width:62%}
    .hero-left h1{font-size:1.6rem;margin:0 0 8px;color:#111}
    .hero-left p{margin:0;color:var(--muted-text)}
    .hero-cta{margin-top:12px;display:flex;gap:12px;flex-wrap:wrap}
    .btn{padding:10px 16px;border-radius:999px;border:none;cursor:pointer;font-weight:700}
    .btn-primary{background:var(--text);color:#fff}
    .btn-ghost{background:transparent;border:1px solid rgba(0,0,0,0.06);color:var(--text)}

    /* side area in hero for top products */
    .hero-right{width:320px;background:linear-gradient(180deg,var(--surface),#fbfbfb);padding:16px;border-radius:12px;border:1px solid var(--muted-2)}
    .hero-right h3{margin:0 0 8px;font-size:1rem;color:#222}
    .top-list{display:grid;gap:10px}
    .top-item{display:flex;gap:12px;align-items:center;cursor:pointer;padding:8px;border-radius:10px;transition:all .12s}
    .top-item:hover{background:var(--muted-1);transform:translateX(-4px)}
    .top-item img{width:72px;height:56px;border-radius:8px;object-fit:cover}

    /* ---------- PRODUCTS GRID / CATALOG ---------- */
    #productos{padding:28px 0}
    .section-head{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:10px}
    .section-title{font-size:1.15rem;color:#111;font-weight:700}
    .section-sub{color:var(--muted-text);font-size:0.95rem}

    .products-grid{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:14px;
    }
    .product-card{
      background:var(--surface);border-radius:12px;padding:12px;box-shadow:0 8px 18px var(--shadow);
      display:flex;flex-direction:column;gap:8px;transition:transform .18s,box-shadow .18s;cursor:pointer;
    }
    .product-card:hover{transform:translateY(-6px);box-shadow:0 20px 36px rgba(0,0,0,0.08)}
    .product-thumb{height:180px;border-radius:10px;overflow:hidden;background:var(--muted-1);display:flex;align-items:center;justify-content:center}
    .product-meta{display:flex;flex-direction:column;gap:6px}
    .product-title{font-weight:700;color:#111;font-size:0.98rem;margin:0}
    .product-desc{color:var(--muted-text);font-size:0.92rem;margin:0}
    .product-row{display:flex;justify-content:space-between;align-items:center;margin-top:auto}

    .price{font-weight:800;color:#111}

    /* ---------- PRODUCT MODAL (center) ---------- */
    .overlay-modal{
      position:fixed;inset:0;background:rgba(0,0,0,0.28);backdrop-filter:blur(4px);opacity:0;visibility:hidden;transition:opacity .22s,z-index 0s;z-index:1400;
    }
    .overlay-modal.show{opacity:1;visibility:visible}
    .product-modal{
      position:fixed;left:50%;top:50%;transform:translate(-50%,-50%) scale(.98);
      width:90%;max-width:980px;height:auto;max-height:86vh;overflow:auto;
      background:linear-gradient(180deg,var(--surface),#fff);border-radius:14px;padding:16px;
      box-shadow:0 30px 90px rgba(0,0,0,0.28);z-index:1450;opacity:0;visibility:hidden;transition:opacity .2s,transform .2s;
    }
    .product-modal.show{opacity:1;visibility:visible;transform:translate(-50%,-50%) scale(1)}
    .modal-grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
    .modal-left img{width:100%;height:320px;object-fit:contain;border-radius:10px;background:var(--muted-1)}
    .thumbs{display:flex;gap:8px;margin-top:8px}
    .thumbs img{width:72px;height:72px;border-radius:8px;object-fit:cover;cursor:pointer;border:1px solid var(--muted-2)}
    .modal-right{display:flex;flex-direction:column;gap:10px;padding:6px}
    .promo{background:linear-gradient(90deg,var(--accent),var(--accent-dark));padding:8px;border-radius:8px;color:#3a2b00;font-weight:700}

    /* pre-form notice */
    .pre-note{
      background:linear-gradient(180deg, rgba(246,200,95,0.12), rgba(228,184,75,0.06));
      border:1px solid rgba(228,184,75,0.12);
      padding:10px;border-radius:8px;color: #3a2b00;font-weight:700;font-size:0.95rem;
    }

    /* mini order form */
    .mini-form{display:flex;flex-direction:column;gap:8px;margin-top:8px}
    .mini-form input,.mini-form textarea,.mini-form select{padding:10px;border-radius:10px;border:1px solid #eee}
    .pay-options{display:flex;gap:8px;flex-wrap:wrap}
    .pay-options label{background:var(--muted-1);padding:6px 8px;border-radius:8px;font-weight:600}

    .pm-msg{display:none;margin-top:8px;font-weight:700;color:green}

    /* rating area */
    .rating-area{display:flex;flex-direction:column;gap:8px}
    .stars-inline{display:flex;gap:6px;font-size:20px;color:#f5c518}
    .rating-badge{font-weight:700;color:var(--text);margin-left:8px}

    /* top notification */
    #topNotif{
      position:fixed;left:50%;transform:translateX(-50%);top:18px;background:#111;color:#fff;padding:10px 16px;border-radius:999px;box-shadow:0 10px 30px rgba(0,0,0,0.16);opacity:0;visibility:hidden;transition:opacity .22s;z-index:9999;font-weight:700;font-size:0.95rem;
    }
    #topNotif.show{opacity:1;visibility:visible}

    /* thank you toast (bottom) */
    .toast{
      position:fixed;left:50%;transform:translateX(-50%);bottom:28px;background:#111;color:#fff;padding:12px 18px;border-radius:999px;box-shadow:0 6px 18px rgba(0,0,0,0.2);opacity:0;visibility:hidden;transition:opacity .25s;
      z-index:1600;
    }
    .toast.show{opacity:1;visibility:visible}

    /* ---------- SIDE PANEL (BURGER MENU) ---------- */
    .side-panel{
      position:fixed;top:0;right:-100%;width:92%;max-width:720px;height:100vh;background:linear-gradient(180deg,#fff,#fbfbfb);
      box-shadow:-40px 0 80px rgba(0,0,0,0.12);border-left:1px solid var(--muted-2);z-index:1550;padding:28px 22px;transition:right .28s cubic-bezier(.2,.9,.2,1);
    }
    .side-panel.show{right:0}
    .panel-inner{display:flex;flex-direction:column;height:100%}
    .panel-header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .panel-links{display:flex;flex-direction:column;gap:10px;margin-top:18px}
    .panel-links a{padding:12px 16px;border-radius:12px;text-decoration:none;color:#111;display:flex;align-items:center;gap:10px;font-weight:700;background:transparent;border:1px solid rgba(0,0,0,0.04)}
    .panel-links a:hover{background:var(--muted-1);transform:translateX(-6px);transition:all .12s}

    /* blur when side-panel open - apply via JS to main content wrapper */
    .blurred{filter:blur(4px);pointer-events:none;user-select:none}

    /* ---------- COMMENTS / REVIEWS LIST ---------- */
    #comentarios{padding:18px 0}
    .review{background:var(--surface);padding:12px;border-radius:10px;border:1px solid var(--muted-2);display:flex;gap:12px;align-items:flex-start}
    .avatar{width:44px;height:44px;border-radius:10px;background:var(--muted-1);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--text)}

    /* ---------- FOOTER ---------- */
    footer{background:var(--muted-2);padding:28px 18px;margin-top:24px}
    .foot-inner{max-width:var(--max-width);margin:0 auto;display:flex;flex-direction:column;align-items:center;gap:12px}
    footer a{color:var(--text);font-weight:700}

    /* ---------- CONTACT PAGE (full-screen interface) ---------- */
    .contact-page{
      position:fixed;inset:0;background:linear-gradient(180deg,var(--surface),#fff);
      z-index:1700;visibility:hidden;opacity:0;transform:translateY(6px);transition:opacity .22s, transform .22s, visibility 0s .22s;
      display:flex;flex-direction:column;align-items:center;padding-top:80px;overflow:auto;
    }
    .contact-page.show{visibility:visible;opacity:1;transform:none;transition-delay:0s;pointer-events:auto}
    .contact-inner{max-width:1100px;width:100%;padding:22px}
    .contact-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px}
    .contact-card{background:var(--surface);padding:18px;border-radius:12px;box-shadow:0 18px 40px rgba(0,0,0,0.06);display:grid;grid-template-columns:1fr 420px;gap:16px}
    .contact-left p{color:var(--muted-text)}
    .map-frame{width:100%;Height:320px;border-radius:10px;border:1px solid var(--muted-2);overflow:hidden}
    .contact-form input,.contact-form textarea,.contact-form select{width:100%;padding:10px;border-radius:8px;border:1px solid #eee}
    .contact-actions{display:flex;gap:10px;align-items:center;margin-top:10px}
    .contact-back{background:transparent;border:1px solid rgba(0,0,0,0.06);padding:8px 12px;border-radius:8px;cursor:pointer}

    /* responsive for contact */
    @media (max-width:1020px){
      .contact-card{grid-template-columns:1fr}
    }

    /* ---------- Responsive ---------- */
    @media (max-width:1020px){
      .products-grid{grid-template-columns:repeat(3,1fr)}
      .modal-grid{grid-template-columns:1fr 320px}
      .hero-left{max-width:100%}
    }
    @media (max-width:820px){
      .products-grid{grid-template-columns:repeat(2,1fr)}
      .hero{grid-template-columns:1fr}
      .hero-right{width:100%}
      .modal-grid{grid-template-columns:1fr}
      .product-modal{max-width:92%}
    }
    @media (max-width:480px){
      header{padding:0 10px}
      .products-grid{grid-template-columns:1fr}
      .hero-card{flex-direction:column;align-items:flex-start}
      .logo{width:40px;height:40px}
      .product-card{padding:10px}
    }
  </style>
</head>
<body>

  <!-- TOP NOTIFICATION -->
  <div id="topNotif" role="status" aria-live="polite"></div>

  <!-- HEADER -->
  <header>
    <div class="brand" aria-hidden="false">
      <div class="logo">HS</div>
      <div>
        <div class="title">HogarSmart</div>
        <div style="font-size:12px;color:var(--muted-text)">Soluciones prácticas para tu hogar</div>
      </div>
    </div>

    <nav class="desktop" aria-hidden="true">
      <!-- kept hidden on mobile; accessible from side panel -->
    </nav>

    <button id="menuBtn" class="hamburger" aria-label="Abrir menú" aria-controls="sidePanel" aria-expanded="false">
      <span class="burger-lines" aria-hidden="true"></span>
    </button>
  </header>

  <!-- SIDE PANEL (BURGER) -->
  <aside id="sidePanel" class="side-panel" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="panel-inner">
      <div class="panel-header">
        <div style="display:flex;gap:12px;align-items:center">
          <div style="font-weight:800;color:#111">HogarSmart</div>
          <div style="color:var(--muted-text)">Menú</div>
        </div>
        <button id="closePanel" class="hamburger" aria-label="Cerrar menú" style="background:transparent;border:none;font-size:20px">✕</button>
      </div>

      <nav class="panel-links" aria-label="Navegación principal">
        <a href="#inicio" data-target="inicio">🏠 Inicio</a>
        <a href="#productos" data-target="productos">🛒 Productos más vendidos</a>
        <a href="#catalogo" data-target="catalogo">📦 Catálogo</a>
        <a href="#comentarios" data-target="comentarios">💬 Comentarios</a>
        <a href="#sobre-nosotros" data-target="sobre-nosotros">🌿 Sobre nosotros</a>
        <a href="#" data-target="contacto">📞 Contacto</a>
        <a href="https://instagram.com" target="_blank" rel="noopener">📸 Instagram</a>
      </nav>

      <div style="margin-top:auto;padding-top:18px;border-top:1px dashed var(--muted-2)">
        <div style="color:var(--muted-text);font-size:0.92rem;margin-bottom:8px">Confianza</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <div style="background:var(--muted-1);padding:8px;border-radius:10px;font-weight:700">🚚 Envíos fáciles</div>
          <div style="background:var(--muted-1);padding:8px;border-radius:10px;font-weight:700">💵 Pago contraentrega</div>
          <div style="background:var(--muted-1);padding:8px;border-radius:10px;font-weight:700">🔧 Soporte</div>
        </div>
      </div>
    </div>
  </aside>

  <!-- OVERLAY (for modal + side-panel) -->
  <div id="overlay" class="overlay" aria-hidden="true"></div>

  <!-- MAIN -->
  <main id="mainContent">
    <div class="container">

      <!-- INICIO / HERO -->
      <section id="inicio">
        <div class="hero">
          <div class="hero-card" role="region" aria-labelledby="heroTitle">
            <div class="hero-left">
              <h1 id="heroTitle">HogarSmart — Haz tu vida más fácil en casa</h1>
              <p>Descubre soluciones prácticas y automatizadas para las tareas diarias. Productos seleccionados para ahorrar tiempo, simplificar procesos y cuidar tu hogar con estilo profesional.</p>

              <div class="hero-cta">
                <button class="btn btn-primary" onclick="scrollToSection('productos')">🛍️ Ver productos más vendidos</button>
                <button class="btn btn-ghost" onclick="scrollToSection('catalogo')">🔎 Ver catálogo completo</button>
              </div>

              <p style="margin-top:12px;color:var(--muted-text)">En HogarSmart nos enfocamos en practicidad, calidad y diseño. Encuentra gadgets y accesorios que realmente facilitan tu día a día.</p>
            </div>

            <aside class="hero-right" aria-label="Top productos">
              <h3>Top productos 🔥</h3>
              <div class="top-list" id="topProductsList">
                <!-- JS will populate: 3-4 top products clickables -->
              </div>
              <div style="margin-top:12px">
                <button class="btn btn-ghost" onclick="scrollToSection('catalogo')">Ver todos los productos</button>
              </div>
            </aside>
          </div>
        </div>
      </section>

      <!-- PRODUCTOS MÁS VENDIDOS (sección destacada) -->
      <section id="productos">
        <div class="section-head">
          <div>
            <div class="section-title">🛒 Productos más vendidos</div>
            <div class="section-sub">Los favoritos por su practicidad</div>
          </div>
          <div style="color:var(--muted-text)">Actualizado recientemente</div>
        </div>

        <div id="productsFeatured" class="products-grid" aria-live="polite">
          <!-- JS will populate 4 featured -->
        </div>
      </section>

      <!-- CATALOGO (todos los productos) -->
      <section id="catalogo">
        <div class="section-head">
          <div>
            <div class="section-title">📦 Catálogo — Todos los productos</div>
            <div class="section-sub">Explora nuestro catálogo completo. Haz clic en un producto para ver detalles y realizar tu pedido.</div>
          </div>
          <div style="color:var(--muted-text)">Filtros próximamente</div>
        </div>

        <div id="catalogGrid" class="products-grid" aria-live="polite">
          <!-- JS will populate 16 products -->
        </div>
      </section>

      <!-- COMENTARIOS -->
      <section id="comentarios">
        <div class="section-head">
          <div>
            <div class="section-title">💬 Comentarios</div>
            <div class="section-sub">Opiniones reales de clientes — (ejemplos de prueba)</div>
          </div>
        </div>

        <div style="display:grid;gap:12px">
          <div class="review">
            <div class="avatar">MA</div>
            <div>
              <div style="display:flex;align-items:center;gap:10px"><div style="font-weight:700">María A.</div><div style="color:var(--muted-text)"> · Bogotá</div></div>
              <div style="margin-top:6px" class="muted">"El organizador plegable cambió mi cocina — ahora todo cabe y se seca rápido."</div>
              <div style="margin-top:8px;color:#f5c518">★★★★★</div>
            </div>
          </div>

          <div class="review">
            <div class="avatar">JC</div>
            <div>
              <div style="display:flex;align-items:center;gap:10px"><div style="font-weight:700">Juan C.</div><div style="color:var(--muted-text)"> · Medellín</div></div>
              <div style="margin-top:6px" class="muted">"La mini aspiradora es compacta y fuerte. Recomendado para apartamentos."</div>
              <div style="margin-top:8px;color:#f5c518">★★★★☆</div>
            </div>
          </div>
        </div>
      </section>

      <!-- SOBRE NOSOTROS -->
      <section id="sobre-nosotros">
        <div class="section-head">
          <div>
            <div class="section-title">🌿 Sobre HogarSmart</div>
            <div class="section-sub">Nuestra misión: simplificar tu día a día</div>
          </div>
        </div>

        <div style="color:var(--muted-text);max-width:920px">
          <p><strong>HogarSmart</strong> es una empresa dedicada a diseñar y seleccionar soluciones prácticas para el hogar, enfocadas en la eficiencia y la comodidad. Nuestro objetivo es que con herramientas inteligentes y productos bien pensados, las tareas cotidianas consuman menos tiempo y energía, permitiéndote disfrutar más de lo que realmente importa.</p>
          <p style="margin-top:8px">Seleccionamos productos por su utilidad, durabilidad y experiencia de uso. Además, facilitamos la compra con opciones seguras de pago —incluyendo pago contraentrega— y envíos rápidos.</p>
        </div>
      </section>

      <!-- CONTACTO (sección de referencia - pero la interfaz real es la "Contact Page") -->
      <section id="contacto" aria-hidden="true">
        <div class="section-head">
          <div>
            <div class="section-title">📞 Contáctanos</div>
            <div class="section-sub">Estamos para ayudarte</div>
          </div>
        </div>

        <div style="display:flex;gap:18px;flex-wrap:wrap;align-items:center">
          <div style="min-width:240px">
            <div style="font-weight:700">Email</div>
            <div style="color:var(--muted-text)">contacto@hogarsmart.com</div>
            <div style="height:12px"></div>
            <div style="font-weight:700">Instagram</div>
            <div style="color:var(--muted-text)">@hogarsmart_oficial</div>
          </div>

          <div style="min-width:260px">
            <div style="font-weight:700">WhatsApp</div>
            <div style="color:var(--muted-text)">+57 321 382 3126</div>
            <div style="height:8px"></div>
            <div style="color:var(--muted-text)">Horario: Lun - Vie 9:00 - 18:00</div>
          </div>
        </div>
      </section>

    </div>

    <footer>
      <div class="foot-inner">
        <div style="font-weight:800;color:#111">© 2025 HogarSmart</div>
        <div style="color:var(--muted-text)">Síguenos en <a href="https://instagram.com" target="_blank" rel="noopener">Instagram</a></div>
      </div>
    </footer>
  </main>

  <!-- OVERLAY for modal specifically (works together with overlay) -->
  <div id="overlayModal" class="overlay-modal" aria-hidden="true"></div>

  <!-- PRODUCT MODAL (central window ~70%) -->
  <div id="productModal" class="product-modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="pmTitle">
    <button id="closeProductModal" class="hamburger" style="position:absolute;right:14px;top:12px;background:transparent;border:none;font-size:18px;cursor:pointer">✕</button>

    <div class="modal-grid">
      <div class="modal-left">
        <img id="pmImage" src="" alt="Imagen producto">
        <div class="thumbs" id="pmThumbs"></div>
      </div>

      <div class="modal-right">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:12px">
          <div>
            <div id="pmTitle" style="font-size:1.05rem;font-weight:800;color:#111"></div>
            <div id="pmSub" style="color:var(--muted-text);margin-top:6px"></div>
          </div>

          <div style="text-align:right">
            <div id="pmPrice" style="font-weight:900;color:#111;font-size:1.05rem"></div>
            <div style="display:flex;align-items:center;justify-content:flex-end;margin-top:8px">
              <div id="pmStars" class="stars-inline">★★★★★</div>
              <div id="pmRatingNum" class="rating-badge"></div>
            </div>
          </div>
        </div>

        <div class="benefits" style="margin-top:10px">
          <strong>Beneficios</strong>
          <ul id="pmBenefits" style="margin:8px 0 0 16px;color:var(--muted-text)"></ul>
        </div>

        <div id="pmPromo" class="promo" style="margin-top:10px">Promoción especial</div>

        <!-- PRE-FORM NOTICE -->
        <div class="pre-note" style="margin-top:12px">
          En cuanto termines el formulario serás redirigido con uno de nuestros asesores para terminar de confirmar tu pedido.
        </div>

        <!-- FORM / ORDER -->
        <div style="margin-top:12px">
          <div style="font-weight:800;margin-bottom:8px">Realizar pedido</div>
          <form id="pmForm" class="mini-form" autocomplete="off" spellcheck="false">
            <!-- Honeypot (hidden) para bots -->
            <div style="display:none">
              <label>Website <input name="website" type="text" autocomplete="off"></label>
            </div>

            <input name="name" id="pm_name" type="text" placeholder="Tu nombre" required>
            <input name="phone" id="pm_phone" type="tel" placeholder="WhatsApp (ej. 3001234567)" pattern="\d{7,15}" title="Ingresa solo números, 7 a 15 dígitos" required>
            <select name="city" id="pm_city" required>
              <option value="">Selecciona ciudad</option>
              <option>Bogotá</option>
              <option>Medellín</option>
              <option>Cali</option>
              <option>Otra</option>
            </select>

            <textarea name="address" id="pm_address" rows="2" placeholder="Dirección (calle, barrio, referencia) — obligatorio" required></textarea>

            <div class="pay-options" style="margin-top:6px">
              <label><input type="radio" name="payMethod" value="contraentrega" checked style="margin-right:6px">Pago contraentrega</label>
              <label><input type="radio" name="payMethod" value="nequi" style="margin-right:6px">Nequi</label>
              <label><input type="radio" name="payMethod" value="daviplata" style="margin-right:6px">Daviplata</label>
              <label><input type="radio" name="payMethod" value="tarjeta" style="margin-right:6px">Tarjeta</label>
            </div>

            <div style="margin-top:8px;display:flex;align-items:center;gap:8px">
              <label style="font-weight:600"><input type="checkbox" name="confirmReal" id="pm_confirmReal" required style="margin-right:8px"> Confirmo que mi pedido es real y los datos son correctos</label>
            </div>

            <div style="display:flex;gap:8px;margin-top:8px">
              <button type="submit" class="btn btn-primary">Enviar pedido</button>
              <button type="button" class="btn btn-ghost" id="pmRateBtn">Calificar</button>
            </div>

            <div id="pmMsg" class="pm-msg">Mensaje</div>
          </form>
        </div>

      </div>
    </div>
  </div>

  <!-- RATING POPUP (inline in modal) -->
  <div id="ratingPopup" class="product-modal" style="max-width:520px;display:none;left:50%;transform:translate(-50%,-50%) scale(.98);">
    <div style="text-align:center;font-weight:800;color:#111;margin-bottom:8px">Valora este producto</div>
    <div class="rate-stars" role="radiogroup" aria-label="Puntuación" style="display:flex;gap:8px;justify-content:center;margin-bottom:8px">
      <button class="rate-btn" data-value="1" aria-label="1 estrella" style="font-size:28px;background:transparent;border:none;cursor:pointer">☆</button>
      <button class="rate-btn" data-value="2" aria-label="2 estrellas" style="font-size:28px;background:transparent;border:none;cursor:pointer">☆</button>
      <button class="rate-btn" data-value="3" aria-label="3 estrellas" style="font-size:28px;background:transparent;border:none;cursor:pointer">☆</button>
      <button class="rate-btn" data-value="4" aria-label="4 estrellas" style="font-size:28px;background:transparent;border:none;cursor:pointer">☆</button>
      <button class="rate-btn" data-value="5" aria-label="5 estrellas" style="font-size:28px;background:transparent;border:none;cursor:pointer">☆</button>
    </div>

    <textarea id="ratingComment" rows="4" placeholder="¿Qué te pareció el producto?"></textarea>
    <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
      <button id="sendRating" class="btn btn-primary">Enviar valoración</button>
      <button id="cancelRating" class="btn btn-ghost">Cancelar</button>
    </div>
  </div>

  <!-- THANK YOU TOAST -->
  <div id="toast" class="toast" role="status" aria-live="polite">¡Gracias por tu valoración!</div>

  <!-- CONTACT PAGE (full-screen interface) -->
  <div id="contactPage" class="contact-page" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="contact-inner">
      <div class="contact-header">
        <div>
          <div style="font-weight:800;font-size:1.2rem">Contacto — HogarSmart</div>
          <div style="color:var(--muted-text)">Estamos listos para ayudarte — escríbenos o visítanos</div>
        </div>
        <div style="display:flex;gap:10px;align-items:center">
          <button id="contactBack" class="contact-back" aria-label="Volver">← Volver</button>
        </div>
      </div>

      <div class="contact-card">
        <div class="contact-left">
          <p style="margin:0 0 12px;color:var(--muted-text)">Completa el formulario o usa los datos de contacto. También puedes ver nuestra ubicación en Bogotá en el mapa a la derecha.</p>

          <form id="contactForm" class="contact-form" autocomplete="off">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
              <input name="name" type="text" placeholder="Tu nombre" required>
              <input name="email" type="email" placeholder="Tu email" required>
            </div>

            <div style="margin-top:8px">
              <input name="subject" type="text" placeholder="Asunto" required>
            </div>

            <div style="margin-top:8px">
              <textarea name="message" rows="6" placeholder="Escribe tu mensaje aquí..." required></textarea>
            </div>

            <div class="contact-actions">
              <button type="submit" class="btn btn-primary">Enviar mensaje</button>
              <button type="button" class="btn btn-ghost" id="contactClose">Cerrar</button>
            </div>

            <div id="contactMsg" style="display:none;margin-top:10px;font-weight:700;color:green"></div>
          </form>

          <div style="margin-top:16px;color:var(--muted-text)">
            <div style="font-weight:700">Email</div>
            <div>contacto@hogarsmart.com</div>
            <div style="height:8px"></div>
            <div style="font-weight:700">WhatsApp</div>
            <div>+57 321 382 3126</div>
            <div style="height:8px"></div>
            <div style="font-weight:700">Horario</div>
            <div>Lun - Vie 9:00 - 18:00</div>
          </div>
        </div>

        <div>
          <!-- OpenStreetMap embed centered on Bogotá (marker approx at 4.6097, -74.0817) -->
          <div class="map-frame" aria-hidden="false">
            <iframe width="100%" height="100%" frameborder="0" scrolling="no"
              src="https://www.openstreetmap.org/export/embed.html?bbox=-74.0930%2C4.6020%2C-74.0470%2C4.6260&layer=mapnik&marker=4.6140,-74.0700"
              style="border:0"></iframe>
          </div>

          <div style="margin-top:10px;color:var(--muted-text);font-size:0.95rem">
            <div style="font-weight:700">Nuestra ubicación</div>
            <div>Bogotá, Colombia (ubicación de referencia)</div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/* ---------- DATA: 7 Productos reales (tus productos seleccionados) ---------- */
const PRODUCTS = [
  { id:'maquina-boxeo', title:'Máquina Boxeo', subtitle:'Caja musical + guantes + adhesivos', price:'COP 100.000', oldPrice:'COP 125.000', images:[
      'https://d39ru7awumhhs2.cloudfront.net/colombia/products/1833423/1748412859IMG_0186.jpeg'
    ], benefits:['Recargable','Incluye guantes','Fácil instalación'], promo:'Oferta', rating:4.5, reviews:34 },
  { id:'perchero-boutique', title:'Perchero Boutique con Zapatero', subtitle:'Estilo y organización', price:'COP 55.000', images:[
      'https://d39ru7awumhhs2.cloudfront.net/colombia/products/734977/1711514172PERCHERO%201.JPG'
    ], benefits:['Fácil montaje','Ahorra espacio'], promo:'', rating:4.3, reviews:21 },
  { id:'perchero-doble', title:'Perchero y Zapatero Organizador Doble', subtitle:'Gran capacidad (hasta 20 pares)', price:'COP 60.000', images:[
      'https://d39ru7awumhhs2.cloudfront.net/colombia/products/1835576/1748621066perchero.png'
    ], benefits:['5 niveles','Ganchos incorporados'], promo:'', rating:4.4, reviews:45 },
  { id:'organizador-bano', title:'Organización de Baño 5pcs', subtitle:'Set modular para ducha', price:'COP 50.000', images:[
      'https://d39ru7awumhhs2.cloudfront.net/colombia/products/1859067/1750533557Captura%20de%20pantalla%202025-06-21%20135509.jpg'
    ], benefits:['Soporte jabón','8 ganchos'], promo:'', rating:4.2, reviews:12 },
  { id:'alfombra-esponjosa', title:'Alfombra Esponjosa Premium', subtitle:'Textura ultra suave', price:'COP 40.000', images:[
      'https://d39ru7awumhhs2.cloudfront.net/colombia/products/1859067/1750533557Captura%20de%20pantalla%202025-06-21%20135509.jpg'
    ], benefits:['Antideslizante','Fácil limpieza'], promo:'', rating:4.3, reviews:18 },
  { id:'cepillo-limpieza', title:'Cepillo Limpieza Hogar Inalámbrico 5en1', subtitle:'Recargable USB, IPX6', price:'COP 45.000', images:[
      'https://d39ru7awumhhs2.cloudfront.net/colombia/products/700560/1710005002Screenshot_1114.jpg'
    ], benefits:['Varios cabezales','Ergonómico'], promo:'Oferta (Antes COP 60.000)', oldPrice:'COP 60.000', rating:4.6, reviews:80 },
  { id:'bascula-inteligente', title:'Báscula Inteligente Bluetooth', subtitle:'Análisis corporal y app', price:'COP 35.000', images:[
      'https://d39ru7awumhhs2.cloudfront.net/colombia/products/1930136/1758208266BASCULA%20BLUETOOTH%208.jpg'
    ], benefits:['Sincroniza con app','Multiusuario'], promo:'', rating:4.5, reviews:66 },
  { id:'mini-batidora', title:'Mini Batidora Picador Eléctrico 2 en 1', subtitle:'Inalámica, 3 velocidades', price:'COP 45.000', images:[
      'https://d39ru7awumhhs2.cloudfront.net/colombia/products/458969/169819239610000963_10422030_1459030.png'
    ], benefits:['Carga USB','Motor 20W'], promo:'', rating:4.4, reviews:44 }
];

/* ---------- Element references ---------- */
const menuBtn = document.getElementById('menuBtn');
const sidePanel = document.getElementById('sidePanel');
const overlay = document.getElementById('overlay');
const closePanel = document.getElementById('closePanel');
const mainContent = document.getElementById('mainContent');

const topProductsList = document.getElementById('topProductsList');
const productsFeatured = document.getElementById('productsFeatured');
const catalogGrid = document.getElementById('catalogGrid');

const productModal = document.getElementById('productModal');
const overlayModal = document.getElementById('overlayModal');
const closeProductModal = document.getElementById('closeProductModal');
const pmImage = document.getElementById('pmImage');
const pmThumbs = document.getElementById('pmThumbs');
const pmTitle = document.getElementById('pmTitle');
const pmSub = document.getElementById('pmSub');
const pmPrice = document.getElementById('pmPrice');
const pmBenefits = document.getElementById('pmBenefits');
const pmPromo = document.getElementById('pmPromo');
const pmStars = document.getElementById('pmStars');
const pmRatingNum = document.getElementById('pmRatingNum');
const pmForm = document.getElementById('pmForm');
const pmMsg = document.getElementById('pmMsg');
const pmRateBtn = document.getElementById('pmRateBtn');

const topNotif = document.getElementById('topNotif');

const ratingPopup = document.getElementById('ratingPopup');
const rateBtns = document.querySelectorAll('.rate-btn');
const sendRatingBtn = document.getElementById('sendRating');
const cancelRatingBtn = document.getElementById('cancelRating');
const ratingComment = document.getElementById('ratingComment');

const toast = document.getElementById('toast');

const contactPage = document.getElementById('contactPage');
const contactBack = document.getElementById('contactBack');
const contactClose = document.getElementById('contactClose');
const contactForm = document.getElementById('contactForm');
const contactMsg = document.getElementById('contactMsg');

let currentProduct = null;

/* ---------- Helpers ---------- */
function renderStars(value){
  const full = Math.floor(value);
  let html = '';
  for(let i=0;i<full;i++) html += '★';
  for(let i=full;i<5;i++) html += '☆';
  return html;
}

/* ---------- Populate top products (3) and featured (4) and catalog ---------- */
function populateListings(){
  // Put products with promo first
  const sorted = [...PRODUCTS].sort((a,b)=>{
    const pa = a.promo ? 0 : 1;
    const pb = b.promo ? 0 : 1;
    return pa - pb;
  });

  // top: first 3
  const top = sorted.slice(0,3);
  topProductsList.innerHTML = '';
  top.forEach((p,i)=>{   // <-- CORRECCIÓN: paréntesis arreglado
    const div = document.createElement('div');
    div.className = 'top-item';
    div.innerHTML = `<img src="${p.images[0]}" alt=""><div><div style="font-weight:700;color:#111">${p.title}</div><div style="color:var(--muted-text)">${p.price}</div></div>`;
    div.addEventListener('click', ()=> openProductModalById(p.id));
    topProductsList.appendChild(div);
  });

  // featured (first 4)
  productsFeatured.innerHTML = '';
  for(let i=0;i<4;i++){
    const p = sorted[i] || PRODUCTS[i];
    if(!p) continue;
    const card = document.createElement('article');
    card.className = 'product-card';
    card.setAttribute('data-id', p.id);
    // show old price if exists and promo badge
    const priceHtml = p.oldPrice ? `<div style="display:flex;flex-direction:column;align-items:flex-end"><div style="text-decoration:line-through;color:var(--muted-text);font-size:0.9rem">${p.oldPrice}</div><div class="price">${p.price}</div></div>` : `<div class="price">${p.price}</div>`;
    const badge = p.promo ? `<div style="background:var(--accent);padding:6px 8px;border-radius:8px;font-weight:800;color:#3a2b00">${p.promo}</div>` : '';
    card.innerHTML = `
      <div class="product-thumb"><img src="${p.images[0]}" alt="${p.title}"></div>
      <div class="product-meta">
        <h3 class="product-title">${p.title} <span style="font-size:12px;color:var(--muted-text);font-weight:600"> · ${p.subtitle}</span></h3>
        <p class="product-desc">${p.benefits[0] || ''}</p>
      </div>
      <div class="product-row">
        ${priceHtml}
        <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
          ${badge}
          <div style="display:flex;gap:8px">
            <button class="btn btn-ghost view-btn" data-id="${p.id}">Ver</button>
            <button class="btn btn-primary buy-btn" data-id="${p.id}">Comprar</button>
          </div>
        </div>
      </div>
    `;
    productsFeatured.appendChild(card);
  }

  // catalog (all)
  catalogGrid.innerHTML = '';
  PRODUCTS.forEach((p, idx)=>{
    const card = document.createElement('article');
    card.className = 'product-card';
    card.setAttribute('data-id', p.id);
    card.innerHTML = `
      <div class="product-thumb"><img src="${p.images[0]}" alt="${p.title}"></div>
      <div class="product-meta">
        <h3 class="product-title">${p.title}</h3>
        <p class="product-desc">${p.subtitle}</p>
      </div>
      <div class="product-row">
        <div style="display:flex;flex-direction:column">
          <div class="price">${p.price}</div>
          <div style="color:var(--muted-text);font-size:12px">${p.rating.toFixed(1)} (${p.reviews})</div>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn btn-ghost view-btn" data-id="${p.id}">Ver</button>
          <button class="btn btn-primary buy-btn" data-id="${p.id}">Comprar</button>
        </div>
      </div>
    `;
    catalogGrid.appendChild(card);
  });
}

/* ---------- Open product modal by id ---------- */
function openProductModalById(id){
  const p = PRODUCTS.find(x=>x.id === id);
  if(!p) return;
  currentProduct = p.id;

  pmImage.src = p.images[0];
  pmThumbs.innerHTML = '';
  p.images.forEach(src=>{
    const im = document.createElement('img');
    im.src = src; im.alt = p.title;
    im.addEventListener('click', ()=> pmImage.src = src);
    pmThumbs.appendChild(im);
  });

  pmTitle.textContent = p.title;
  pmSub.textContent = p.subtitle;
  // show old price if exists
  if(p.oldPrice){
    pmPrice.innerHTML = `<div style="text-decoration:line-through;color:var(--muted-text);font-size:0.95rem">${p.oldPrice}</div><div style="font-weight:900;color:#111;font-size:1.05rem">${p.price}</div>`;
  } else {
    pmPrice.textContent = p.price;
  }
  pmPromo.textContent = p.promo || '';
  pmBenefits.innerHTML = (p.benefits || []).map(b=>`<li>${b}</li>`).join('');
  pmStars.textContent = renderStars(p.rating || 5);
  pmRatingNum.textContent = p.reviews ? `${p.rating.toFixed(1)} (${p.reviews})` : '';

  // show overlay & modal and blur content
  overlay.classList.add('show');
  overlayModal.classList.add('show');
  productModal.classList.add('show');
  mainContent.classList.add('blurred');

  document.getElementById('pmForm').reset();
  pmMsg.style.display = 'none';
}

/* ---------- Close product modal ---------- */
function closeProductModalFn(){
  productModal.classList.remove('show');
  overlayModal.classList.remove('show');
  overlay.classList.remove('show');
  mainContent.classList.remove('blurred');
  currentProduct = null;
}

/* ---------- Menu (side panel) open/close ---------- */
function openSide(){
  sidePanel.classList.add('show');
  overlay.classList.add('show');
  menuBtn.classList.add('open');
  mainContent.classList.add('blurred');
  menuBtn.setAttribute('aria-expanded','true');
}
function closeSide(){
  sidePanel.classList.remove('show');
  overlay.classList.remove('show');
  menuBtn.classList.remove('open');
  mainContent.classList.remove('blurred');
  menuBtn.setAttribute('aria-expanded','false');
}

/* ---------- Contact page open/close (new interface) ---------- */
function openContactPage(){
  // close side first
  closeSide();
  // show contact page with overlay blur
  contactPage.classList.add('show');
  overlay.classList.add('show');
  mainContent.classList.add('blurred');
  contactPage.setAttribute('aria-hidden','false');
}
function closeContactPage(){
  contactPage.classList.remove('show');
  overlay.classList.remove('show');
  mainContent.classList.remove('blurred');
  contactPage.setAttribute('aria-hidden','true');
}

/* ---------- Wire events ---------- */
menuBtn.addEventListener('click', ()=> {
  if(sidePanel.classList.contains('show')) closeSide();
  else openSide();
});
closePanel.addEventListener('click', closeSide);

// overlay closes modal, side, contact page or rating
overlay.addEventListener('click', ()=>{
  if(sidePanel.classList.contains('show')) closeSide();
  if(productModal.classList.contains('show')) closeProductModalFn();
  if(contactPage.classList.contains('show')) closeContactPage();
  if(ratingPopup.style.display === 'block') closeRatingPopup();
});

// close product modal btn
closeProductModal.addEventListener('click', closeProductModalFn);

/* ---------- Delegate click on view / buy buttons (for featured & catalog) ---------- */
document.addEventListener('click', (e)=>{
  const v = e.target.closest('.view-btn');
  if(v){ const id = v.dataset.id; openProductModalById(id); return; }
  const b = e.target.closest('.buy-btn');
  if(b){ const id = b.dataset.id; openProductModalById(id); setTimeout(()=> document.querySelector('#pmForm input[name="name"]').focus(),250); return; }
  // card click (open)
  const card = e.target.closest('.product-card');
  if(card && !e.target.closest('button')) {
    const id = card.getAttribute('data-id');
    if(id) openProductModalById(id);
  }
});

/* ---------- Form submit (validate + redirect to WhatsApp) ---------- */
pmForm.addEventListener('submit', (e)=>{
  e.preventDefault();

  // honeypot check
  const hp = pmForm.querySelector('input[name="website"]');
  if(hp && hp.value){
    // probable bot - silently fail
    pmMsg.style.display = 'block';
    pmMsg.style.color = 'crimson';
    pmMsg.textContent = 'Error en el envío. Intenta de nuevo.'; 
    return;
  }

  const name = (document.getElementById('pm_name')||{}).value && (document.getElementById('pm_name')||{}).value.trim();
  const phone = (document.getElementById('pm_phone')||{}).value && (document.getElementById('pm_phone')||{}).value.trim();
  const city = (document.getElementById('pm_city')||{}).value;
  const address = (document.getElementById('pm_address')||{}).value && (document.getElementById('pm_address')||{}).value.trim();
  const confirmReal = (document.getElementById('pm_confirmReal')||{}).checked;

  // basic validation
  if(!name || !phone || !city || !address || !confirmReal){
    pmMsg.style.display = 'block';
    pmMsg.style.color = 'crimson';
    pmMsg.textContent = 'Por favor completa todos los campos obligatorios y confirma que tu pedido es real.';
    return;
  }

  // phone digits only check
  const digits = phone.replace(/\D/g,'');
  if(!(digits.length >= 7 && digits.length <= 15)){
    pmMsg.style.display = 'block';
    pmMsg.style.color = 'crimson';
    pmMsg.textContent = 'Por favor ingresa un número de teléfono válido (solo números).';
    return;
  }

  // retrieve product title safely
  const prodTitle = pmTitle.textContent || 'Producto';

  // show top notification
  showTopNotif('✅ Tu pedido ha sido enviado correctamente. En breve serás redirigido a nuestro WhatsApp para confirmar tu pedido.');

  // prepare whatsapp message and link
  const businessNumber = '573213823126'; // +57 3213823126 -> 57 + 3213823126
  const message = `👋 Hola, soy ${name}.%0AQuiero pedir el producto *${prodTitle}* con envío *contraentrega* a:%0A📍 ${address} — ${city}%0ATel: ${digits}`;
  const waLink = `https://wa.me/${businessNumber}?text=${encodeURIComponent(message)}`;

  // small delay so user sees notification, then redirect/open WA
  setTimeout(()=>{
    // open in new tab if possible, otherwise navigate
    try{
      window.open(waLink, '_blank');
      // On mobile, also set location (some browsers require)
      setTimeout(()=> { window.location.href = waLink; }, 600);
    }catch(err){
      window.location.href = waLink;
    }
    // reset form UI
    pmForm.reset();
    pmMsg.style.display = 'none';
    // close modal after redirect attempt
    setTimeout(()=> {
      closeProductModalFn();
    }, 800);
  }, 2500);
});

/* ---------- Top notification helper ---------- */
let topTimer = null;
function showTopNotif(text){
  topNotif.textContent = text;
  topNotif.classList.add('show');
  if(topTimer) clearTimeout(topTimer);
  topTimer = setTimeout(()=> topNotif.classList.remove('show'), 6000);
}

/* ---------- Rating popup logic ---------- */
function openRatingPopup(){
  if(currentProduct === null){ alert('Abre un producto antes de valorar.'); return; }
  ratingPopup.style.display = 'block';
  overlay.classList.add('show');
  mainContent.classList.add('blurred');
  // reset stars UI
  rateBtns.forEach(b => b.textContent = '☆');
  ratingComment.value = '';
  selectedRating = 5;
  for(let i=0;i<selectedRating;i++) rateBtns[i].textContent='★';
}
function closeRatingPopup(){
  ratingPopup.style.display = 'none';
  overlay.classList.remove('show');
  mainContent.classList.remove('blurred');
}
let selectedRating = 5;
rateBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    selectedRating = Number(btn.dataset.value);
    rateBtns.forEach(b=> b.textContent = (Number(b.dataset.value) <= selectedRating) ? '★':'☆');
  });
});
cancelRatingBtn.addEventListener('click', closeRatingPopup);

sendRatingBtn.addEventListener('click', ()=>{
  if(currentProduct === null) return;
  const prod = PRODUCTS.find(p => p.id === currentProduct);
  if(!prod) return;
  const total = prod.rating * prod.reviews;
  prod.reviews = (prod.reviews || 0) + 1;
  prod.rating = ((total + selectedRating) / prod.reviews);
  // update UI in modal
  pmStars.textContent = renderStars(prod.rating);
  pmRatingNum.textContent = `${prod.rating.toFixed(1)} (${prod.reviews})`;
  closeRatingPopup();
  showToast('Gracias por tu valoración — tu opinión ayuda mucho.');
});

/* ---------- Open rating from modal button ---------- */
pmRateBtn.addEventListener('click', (e)=>{
  e.preventDefault();
  openRatingPopup();
});

/* ---------- Auto-close sidePanel when clicking any link inside it ---------- */
const panelLinks = document.querySelectorAll('#sidePanel a');
panelLinks.forEach(link=>{
  link.addEventListener('click', (ev)=>{
    const target = link.getAttribute('data-target');
    if(target && target !== 'contacto'){
      ev.preventDefault();
      closeSide();
      setTimeout(()=> scrollToSection(target), 220);
    } else if(target === 'contacto') {
      ev.preventDefault();
      // open contact page (new interface)
      openContactPage();
    } else {
      // external (instagram etc) : just close
      closeSide();
    }
  });
});

/* ---------- Smooth scroll helper ---------- */
function scrollToSection(id){
  const el = document.getElementById(id);
  if(!el) return;
  el.scrollIntoView({behavior:'smooth', block:'start'});
}

/* ---------- Toast helper ---------- */
let toastTimer = null;
function showToast(text){
  toast.textContent = text;
  toast.classList.add('show');
  if(toastTimer) clearTimeout(toastTimer);
  toastTimer = setTimeout(()=> toast.classList.remove('show'), 3000);
}

/* ---------- Init populate and animation ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  populateListings();

  // animate product cards (small entrance)
  document.querySelectorAll('.product-card').forEach((c,i)=>{
    c.style.opacity = 0;
    c.style.transform = 'translateY(8px)';
    setTimeout(()=>{ c.style.transition = 'opacity .45s ease, transform .45s ease'; c.style.opacity = 1; c.style.transform = 'none'; }, 80 * i);
  });

  // ensure featured and top clickable buttons wired (if dynamic)
  document.querySelectorAll('.view-btn, .buy-btn').forEach(b => b.addEventListener('click', e => e.stopPropagation()));

  // check URL param to open specific product directly e.g. ?producto=maquina-boxeo or ?producto=id
  const url = new URL(window.location.href);
  const prodParam = url.searchParams.get('producto') || url.searchParams.get('product') || url.searchParams.get('p');
  if(prodParam){
    // try to find by id or partial match
    const found = PRODUCTS.find(p => p.id === prodParam || p.id.includes(prodParam) || p.title.toLowerCase().includes(prodParam.toLowerCase()));
    if(found) setTimeout(()=> openProductModalById(found.id), 300);
  }
});

/* ---------- Accessibility: ESC to close modals/panels/pages ---------- */
window.addEventListener('keydown',(e)=>{
  if(e.key === 'Escape'){
    if(ratingPopup.style.display === 'block') closeRatingPopup();
    else if(productModal.classList.contains('show')) closeProductModalFn();
    else if(sidePanel.classList.contains('show')) closeSide();
    else if(contactPage.classList.contains('show')) closeContactPage();
  }
});

/* ---------- Ensure clicking a top featured opens modal (redundant safety) ---------- */
topProductsList.addEventListener('click',(e)=>{
  const card = e.target.closest('.top-item');
  if(card) {
    const idx = Array.from(topProductsList.children).indexOf(card);
    if(idx>=0){
      const p = PRODUCTS[idx];
      if(p) openProductModalById(p.id);
    }
  }
});

/* ---------- Contact page controls ---------- */
contactBack.addEventListener('click', ()=> closeContactPage());
contactClose.addEventListener('click', ()=> closeContactPage());

contactForm.addEventListener('submit', (e)=>{
  e.preventDefault();
  const fd = new FormData(contactForm);
  if(!fd.get('name') || !fd.get('email') || !fd.get('message')){
    contactMsg.style.display = 'block';
    contactMsg.style.color = 'crimson';
    contactMsg.textContent = 'Por favor completa los campos obligatorios.';
    return;
  }
  // simulate sending
  contactMsg.style.display = 'block';
  contactMsg.style.color = 'green';
  contactMsg.textContent = '✅ Mensaje enviado. Te responderemos pronto.';
  contactForm.reset();

  // after 2s close and show toast
  setTimeout(()=>{
    closeContactPage();
    showToast('Gracias por contactarnos — revisaremos tu mensaje.');
    contactMsg.style.display = 'none';
  }, 1800);
});

</script>

</body>
</html>
